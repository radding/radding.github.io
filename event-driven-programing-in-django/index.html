<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Event Driven Programing In Django - Yoseph.TECH | All things Tech</title>
	<meta name="description" content="Event driven programming is an extremely powerful paradigm that allows you to perform some action because something else happened (the event). Django already has a rudimentary event system in its core, but it left things to be desired. Learn more about event driven programming in django and the inspiration behind django-event-system">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<!-- OG tags -->
	<meta property="og:image" content="/assets/img/events-icon.gif"/>
	<meta property="og:title" content="Event Driven Programing In Django - Yoseph.TECH | All things Tech" />
	<meta property='og:description' content='Event driven programming is an extremely powerful paradigm that allows you to perform some action because something else happened (the event). Django already has a rudimentary event system in its core, but it left things to be desired. Learn more about event driven programming in django and the inspiration behind django-event-system'/>
	<meta property="og:type" content="article" />
	<meta property='og:url' content='/event-driven-programing-in-django/' />

	<link rel="shortcut icon" href="/assets/img/favicon/favicon.ico" type="image/x-icon">
	<link rel="apple-touch-icon" href="/assets/img/favicon/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicon/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicon/apple-touch-icon-114x114.png">
	<!-- Chrome, Firefox OS and Opera -->
	<meta name="theme-color" content="#d25469">
	<!-- Windows Phone -->
	<meta name="msapplication-navbutton-color" content="#d25469">
	<!-- iOS Safari -->
	<meta name="apple-mobile-web-app-status-bar-style" content="#d25469">
	<!-- Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
	<link rel="stylesheet" href="/assets/fonts/font-awesome/css/font-awesome.min.css">
	<!-- Styles -->
	<link rel="stylesheet" href="/assets/css/main.css">
</head>

<body>

  
<header class="main_header">
  <a href="/" class="logo">Yoseph<span>.TECH</span></a>
  <nav class="main_menu">
    <a href="/about/">About</a>
    <a href="/contact/">Contact</a>
  </nav>
</header> <!-- End Section Header -->

<main class="post_content">
  <article class="post">
    <header>
      <div class="post_image">
        <img src=/assets/img/events-icon.gif alt="Event Driven Programing In Django">
      </div>
      <div class="post_description">
        <p class="post_meta">2018, Feb 26</p>
        <h1 class="post_title">Event Driven Programing In Django</h1>
      </div>
    </header> <!-- End Header -->

    <div class="entry_content">
      <p>I have been doing a lot of professional work in <a href="https://laravel.com/" target="__blank">laravel</a> recently for <a href="http://splt.io/" target="__blank">SPLT</a>, but recently I went back to django for a project I am currently working on in my spare time. I love django, but there are some great things that laravel has that Django doesn’t, like supporting the <a href="https://en.wikipedia.org/wiki/Observer_pattern" target="__blank">observer pattern</a> on models.</p>

<p>That Observer pattern is what inspired me to implement a string based event system in django.</p>

<h2 id="the-problem">The Problem</h2>
<p>Have you ever wanted to perform some action when something else happens? For example, when you create a new user you usually want to send them a “verify your email” email? That is really what the observer pattern is about; you tell some object (the subject) about these other objects (the observers) and then when something happens to the subject, it will call some method on the observers.</p>

<figure>
  <img src="/assets/img/observers.png" alt="*Observers are basically like shouting from the roof tops; One object shouts and the observers will do whatever it needs to do*" class="" />
  <figcaption><p><em>Observers are basically like shouting from the roof tops; One object shouts and the observers will do whatever it needs to do</em></p>
</figcaption>
</figure>

<p>Laravel has great support for <a href="https://laravel.com/docs/5.6/eloquent#observers" target="__blank">model observers</a>; you need to simply create an observer class that implements certian functions, and then you tell the model class that this observer is observing you like so: <code class="highlighter-rouge">User::observe(UserObserver::class);</code></p>

<p>I wanted this behaviour in my latest project, where when you create a service object in my database, it also creates a service object in AWS. Django implements this behaviour by using <a href="https://docs.djangoproject.com/en/2.0/topics/signals/" target="__blank">Signals</a>. But it’s not so easy to know if the object is in the process of creating, already created, updating, already updated, deleting, or already deleted.</p>

<p>At first, I thought I would just define an Observerable model. But then I realized, I could implement a better event system and have great Model observers!</p>

<h2 id="the-thinking">The thinking</h2>
<p>I think django signals are great! But they’re not so great when you want to listen to multiple signals. Using laravel as my inspiration, I wanted to be able to define a regular expression string in order to respond to every event that matches that string. For example, if I had multiple classes of assets all of which needed to send out an email when they got updated, I would like to listen to <code class="highlighter-rouge">event::assets::updated::(.*)</code> to listen for every updated event. Using django signal, you would have to register the same callback over and over again.</p>

<p>Then, in order to implement observers for Models, all I would really have to do is to map the models built in signal to events and define listeners for those events.</p>

<h2 id="the-solution">The Solution</h2>
<p>The final solution I came up with is already on <a href="https://github.com/radding/django-event-system" target="__blank">github</a> and PyPi(https://pypi.python.org/pypi/django-event-system){:target=’__blank’}, so you can skip ahead and look at those if you would like.</p>

<p>I wanted this system to be simple to use and extensible. In the future, I would like this library to support multi-server deployments and evolve into using django channels. And in order to not impact performance, I decided to use <a href="'http://www.gevent.org/'" target="__blank">gevent</a> to not block execution. I won’t go into great details, because you can read the <code class="highlighter-rouge">README.md</code> in the github repo, but I’ll explain some of the decisions I made.</p>

<h3 id="metaclasses">Metaclasses</h3>
<p>I chose to make use of metaclasses for the seemingly black magic. I like when things just work with out having to call start up methods, so I decided to use metaclasses to handle getting everything set up. These metaclasses do everything from starting a Greenlet for background tasks, to registering handlers for the various events, to mapping signals for Models to events.</p>

<p>When the classes are loaded into memory, the behaviour in the metaclass is executed, causeing the class to be ready to use with out any additional code. Just inherit from the class you want to implement and be on your way.</p>

<h3 id="gevent">Gevent</h3>
<p>I use Gevent in order to make this event system non-blocking. The dispatch handler is put in the background if there is nothing in the event queue, and not woken up until execution is passed back to it using something like <code class="highlighter-rouge">gevent.sleep()</code>. While this makes the events less predictable as to when exactly they will be handled, it stops your application from slowing down or breaking if there is an error in your event handlers.</p>

<h3 id="helper-methods">Helper methods</h3>
<p>Finally, I implemented some helper methods, namely <code class="highlighter-rouge">SignalToEvent</code> and <code class="highlighter-rouge">RegisterSignalsFor</code>, in order to aid moving away from django signals and into django-event-system.</p>

<h2 id="the-wrap-up">The wrap up</h2>
<p>This library was a lot of fun to build, and I would love to see it grow. There are a few things I am planning in the near team, such as implementing a decorator that you can use on a function to handle events to register it, a django command to make it easier to generate events, listeners, and observers, and implement priority for events. In the longer term, I want to see django channels suppport, multi-server support (all though I’m not sure about the feasibilty of this, because of locking), and maybe even seperating the base event system into its own library for events.</p>

<p>You can checkout the <a href="https://github.com/radding/django-event-system" target="__blank">repo for this project here</a>. If you have any comments, questions or concerns, let me know either below or via email! Thanks for reading!</p>

    </div>
    
    <div class="post_wrapper">
      <footer class="post_footer cf">
        <div class="post_share">
          <span>Share:</span>
          <a href="https://twitter.com/intent/tweet?text=Event Driven Programing In Django&url=http://yoseph.tech/event-driven-programing-in-django/" title="Share on Twitter" rel="nofollow" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
          <a href="https://facebook.com/sharer.php?u=http://yoseph.tech/event-driven-programing-in-django/" title="Share on Facebook" rel="nofollow" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
          <a href="https://plus.google.com/share?url=http://yoseph.tech/event-driven-programing-in-django/" title="Share on Google+" rel="nofollow" target="_blank"><i class="fa fa-google" aria-hidden="true"></i></a>
        </div>
        <div class="post_tag">
          <span>Tags:</span>
          
          <a href="/tags#event," class="tag">event,</a>
          
          <a href="/tags#event" class="tag">event</a>
          
          <a href="/tags#driven," class="tag">driven,</a>
          
          <a href="/tags#django," class="tag">django,</a>
          
          <a href="/tags#django-event-system" class="tag">django-event-system</a>
          
        </div>
      </footer>
    </div>
  </article> <!-- End Section Post -->

  <section class="author cf">
    <div class="post_wrapper">
      <div class="author_image">
        <img src="/assets/img/face.jpg" alt="Author face">
      </div>
      <div class="author_info">
        <h2 class="author_title">Yoseph Radding</h2>
        <p class="author_subtitle"><p>Entrepreneur, Software Guru, Product Guy, 2017 HackerFellow and most importantly, a <strong>full blown Geek</strong>.</p>
</p>
        <div class="author_social">
          
          <span class="author_email"><i class="fa fa-envelope-o" aria-hidden="true"></i> <a href="mailto:yoseph@shuttl.io">yoseph@shuttl.io</a></span>
          
          
          

          
          <span class="author_website"><i class="fa fa-link" aria-hidden="true"></i> <a href="http://yoseph.tech" target="_blank">http://yoseph.tech</a></span>
          
          
            <span>
              <a href="https://twitter.com/raddingy" target="_blank">
                <i class="fa fa-twitter" aria-hidden="true"></i> @raddingy
              </a>
            </span>
          
        </div>
      </div>
    </div>
  </section> <!-- End Section Author -->

  <section class="recent_box">
    <div class="post_wrapper">
      <h2 class="recent_title">Recent posts</h2>
      <div class="recent_list">
        
          
            <a href="/event-driven-programing-in-django/" class="recent_item" style="background-image: url( /assets/img/events-icon.gif )"><span>Event Driven Programing In Django</span></a>
          
        
          
            <a href="/completely-useless-fun-project-building-the-parser/" class="recent_item" style="background-image: url( /assets/img/parser.png )"><span>Completely Useless Fun Project: Building The Parser</span></a>
          
        
          
            <a href="/completely-useless-fun-project-parts-of-the-compiler/" class="recent_item" style="background-image: url( /assets/img/compilers.jpg )"><span>Completely Useless Fun Project: Parts Of The Compiler</span></a>
          
        
          
            <a href="/completely-useless-fun-project-build-a-new-programming-language/" class="recent_item" style="background-image: url( /assets/img/programming-languages.jpg )"><span>Completely Useless Fun Project: Building A New Programming Language</span></a>
          
        
          
            <a href="/building-production-code/" class="recent_item" style="background-image: url( /assets/img/code_screen_shot.jpg )"><span>Building Production Code</span></a>
          
        
          
            <a href="/building-an-arcade-controller/" class="recent_item" style="background-image: url( /assets/img/rpi_arcade1.png )"><span>Building An Arcade Controller</span></a>
          
        
      </div>
    </div>
  </section> <!-- End Section Recent Box -->
  
  
<section class="comment_area">
  <div class="comment_wrapper">
    
    <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://yoseph-tech.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
    
  </div>
</section> <!-- End Section Comment Area -->
  
</main> <!-- End Section Post Content -->


<footer class="main_footer">
  <div class="wrapper">
    
<ul class="social_footer">
  
  
    <li><a href="https://twitter.com/raddingy" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
  
  
  
    <li><a href="https://www.linkedin.com/in/yosephradding/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
  
  
  
  
    <li><a href="https://github.com/radding" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a></li>
  
</ul>
    <div class="copyright">
      <p>&copy; 2018 All rights reserved. Yoseph Radding. Design by <a href="https://artemsheludko.github.io" target="_blank">Artem Sheludko</a></p>
      <p><em>All opinions expressed are my own</em></p>
    </div>
  </div>
</footer> <!-- End Section Footer -->


  
<div class="top" title="Top"><i class="fa fa-chevron-up" aria-hidden="true"></i></div> <!-- End Top Scroll -->
  
<script src="/assets/js/jquery-3.2.1.min.js"></script>
<script src="/assets/js/jquery.vide.min.js"></script>
<script src="/assets/js/custom.js"></script>
<script id="dsq-count-scr" src="//yoseph-tech.disqus.com/count.js" async></script>
<!-- End Javascript -->

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83670049-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-83670049-2');
</script>

</body>
</html>
